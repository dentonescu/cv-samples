package dev.dmotservices.api;

import dev.dmotservices.io.FileUtils;

import java.io.IOException;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public enum MimeType {
    /*
     * A short list of common mimetypes.
     * comprehensive list 1: https://mimetype.io/all-types
     * comprehensive list 2: https://github.com/amr/mimetypes/blob/master/src/main/resources/mime.types
     */

    // non-file types
    FORM_URL_ENCODED("application/x-www-form-urlencoded"),
    MULTIPART_FORM_DATA("multipart/form-data"),

    // my aliases
    JAVASCRIPT("text/javascript"),
    JPEG_STANDARD("image/jpeg"),

    // file types <-- entries generated from MimeTypeTests.testGenerateMimeTypeList()
    _0123("application/vnd.lotus-1-2-3"),
    _3DML("text/vnd.in3d.3dml"),
    _3G2("audio/mp4"),
    _3GA("audio/mp4"),
    _3GP("audio/mp4"),
    _3GP2("audio/mp4"),
    _3GPA("audio/mp4"),
    _3GPP("audio/mp4"),
    _3GPP2("audio/mp4"),
    _7Z("application/x-7z-compressed"),
    A("application/octet-stream"),
    AAB("application/x-authorware-bin"),
    AAC("audio/aac"),
    AACP("audio/aacp"),
    AAM("application/x-authorware-map"),
    AAS("application/x-authorware-seg"),
    ABW("application/x-abiword"),
    ABWGZ("application/x-abiword"),
    ACC("application/vnd.americandynamics.acc"),
    ACE("application/x-ace-compressed"),
    ACU("application/vnd.acucobol"),
    ACUTC("application/vnd.acucorp"),
    ADP("audio/adpcm"),
    AEP("application/vnd.audiograph"),
    AFF("audio/aiff"),
    AFM("application/x-font-type1"),
    AFP("application/vnd.ibm.modcap"),
    AI("application/postscript"),
    AIF("audio/aiff"),
    AIFF("audio/aiff"),
    AIR("application/vnd.adobe.air-application-installer-package+zip"),
    AMI("application/vnd.amiga.ami"),
    APK("application/vnd.android.package-archive"),
    APPLICATION("application/x-ms-application"),
    APR("application/vnd.lotus-approach"),
    ARW("image/x-sony-arw"),
    ASC("application/pgp-signature"),
    ASF("video/x-ms-asf"),
    ASM("text/x-asm"),
    ASO("application/vnd.accpac.simply.aso"),
    ASX("video/x-ms-asf"),
    ATC("application/vnd.acucorp"),
    ATOM("application/atom+xml"),
    ATOMCAT("application/atomcat+xml"),
    ATOMSVC("application/atomsvc+xml"),
    ATX("application/vnd.antix.game-component"),
    AU("audio/basic"),
    AVI("video/x-msvideo"),
    AVIF("image/avif"),
    AVIFS("image/avif-sequence"),
    AW("application/applixware"),
    AZF("application/vnd.airzip.filesecure.azf"),
    AZS("application/vnd.airzip.filesecure.azs"),
    AZW("application/vnd.amazon.ebook"),
    BAT("application/x-msdownload"),
    BCPIO("application/x-bcpio"),
    BDF("application/x-font-bdf"),
    BDM("application/vnd.syncml.dm+wbxml"),
    BH2("application/vnd.fujitsu.oasysprs"),
    BIN("application/octet-stream"),
    BMI("application/vnd.bmi"),
    BMP("image/bmp"),
    BOOK("application/vnd.framemaker"),
    BOX("application/vnd.previewsystems.box"),
    BOZ("application/x-bzip2"),
    BPK("application/octet-stream"),
    BTIF("image/prs.btif"),
    BZ("application/x-bzip"),
    BZ2("application/x-bzip2"),
    C("text/x-c"),
    C4D("application/vnd.clonk.c4group"),
    C4F("application/vnd.clonk.c4group"),
    C4G("application/vnd.clonk.c4group"),
    C4P("application/vnd.clonk.c4group"),
    C4U("application/vnd.clonk.c4group"),
    CAB("application/vnd.ms-cab-compressed"),
    CAR("application/vnd.curl.car"),
    CAT("application/vnd.ms-pki.seccat"),
    CC("text/x-c"),
    CCT("application/x-director"),
    CCXML("application/ccxml+xml"),
    CDBCMSG("application/vnd.contact.cmsg"),
    CDF("application/x-netcdf"),
    CDKEY("application/vnd.mediastation.cdkey"),
    CDR("application/x-iso9660-image"),
    CDX("chemical/x-cdx"),
    CDXML("application/vnd.chemdraw+xml"),
    CDY("application/vnd.cinderella"),
    CER("application/pkix-cert"),
    CGM("image/cgm"),
    CHAT("application/x-chat"),
    CHM("application/vnd.ms-htmlhelp"),
    CHRT("application/vnd.kde.kchart"),
    CIF("chemical/x-cif"),
    CII("application/vnd.anser-web-certificate-issue-initiation"),
    CIL("application/vnd.ms-artgalry"),
    CLA("application/vnd.claymore"),
    CLASS("application/java-vm"),
    CLKK("application/vnd.crick.clicker.keyboard"),
    CLKP("application/vnd.crick.clicker.palette"),
    CLKT("application/vnd.crick.clicker.template"),
    CLKW("application/vnd.crick.clicker.wordbank"),
    CLKX("application/vnd.crick.clicker"),
    CLP("application/x-msclip"),
    CMC("application/vnd.cosmocaller"),
    CMDF("chemical/x-cmdf"),
    CML("chemical/x-cml"),
    CMP("application/vnd.yellowriver-custom-menu"),
    CMX("image/x-cmx"),
    COD("application/vnd.rim.cod"),
    COM("application/x-msdownload"),
    CONF("text/plain"),
    CPIO("application/x-cpio"),
    CPP("text/x-c"),
    CPT("application/mac-compactpro"),
    CR2("image/x-canon-cr2"),
    CRD("application/x-mscardfile"),
    CRL("application/pkix-crl"),
    CRT("application/x-x509-ca-cert"),
    CRW("image/x-canon-crw"),
    CSH("application/x-csh"),
    CSML("chemical/x-csml"),
    CSP("application/vnd.commonspace"),
    CSS("text/css"),
    CST("application/x-director"),
    CSV("text/csv"),
    CU("application/cu-seeme"),
    CURL("text/vnd.curl"),
    CWW("application/prs.cww"),
    CXT("application/x-director"),
    CXX("text/x-c"),
    DAF("application/vnd.mobius.daf"),
    DATALESS("application/vnd.fdsn.seed"),
    DAVMOUNT("application/davmount+xml"),
    DB("application/vnd.sqlite3"),
    DB_SHM("application/vnd.sqlite3"),
    DB_WAL("application/vnd.sqlite3"),
    DCR("application/x-director"),
    DCURL("text/vnd.curl.dcurl"),
    DD2("application/vnd.oma.dd2+xml"),
    DDD("application/vnd.fujixerox.ddd"),
    DEB("application/vnd.debian.binary-package"),
    DEF("text/plain"),
    DEPLOY("application/octet-stream"),
    DER("application/x-x509-ca-cert"),
    DFAC("application/vnd.dreamfactory"),
    DIC("text/x-c"),
    DIFF("text/plain"),
    DIR("application/x-director"),
    DIS("application/vnd.mobius.dis"),
    DIST("application/octet-stream"),
    DISTZ("application/octet-stream"),
    DJV("image/vnd.djvu"),
    DJVU("image/vnd.djvu"),
    DLL("application/x-msdownload"),
    DMG("application/octet-stream"),
    DMS("application/octet-stream"),
    DNA("application/vnd.dna"),
    DNG("image/x-adobe-dng"),
    DOC("application/msword"),
    DOCM("application/vnd.ms-word.document.macroenabled.12"),
    DOCX("application/vnd.openxmlformats-officedocument.wordprocessingml.document"),
    DOT("application/msword"),
    DOTM("application/vnd.ms-word.template.macroenabled.12"),
    DOTX("application/vnd.openxmlformats-officedocument.wordprocessingml.template"),
    DP("application/vnd.osgi.dp"),
    DPG("application/vnd.dpgraph"),
    DSC("text/prs.lines.tag"),
    DTB("application/x-dtbook+xml"),
    DTD("application/xml-dtd"),
    DTS("audio/vnd.dts"),
    DTSHD("audio/vnd.dts.hd"),
    DUMP("application/octet-stream"),
    DVI("application/x-dvi"),
    DWF("model/vnd.dwf"),
    DWG("image/vnd.dwg"),
    DXF("image/vnd.dxf"),
    DXP("application/vnd.spotfire.dxp"),
    DXR("application/x-director"),
    ECELP4800("audio/vnd.nuera.ecelp4800"),
    ECELP7470("audio/vnd.nuera.ecelp7470"),
    ECELP9600("audio/vnd.nuera.ecelp9600"),
    ECMA("application/ecmascript"),
    EDM("application/vnd.novadigm.edm"),
    EDX("application/vnd.novadigm.edx"),
    EFIF("application/vnd.picsel"),
    EI6("application/vnd.pg.osasli"),
    ELC("application/octet-stream"),
    EML("message/rfc822"),
    EMMA("application/emma+xml"),
    EOL("audio/vnd.digital-winds"),
    EOT("application/vnd.ms-fontobject"),
    EPS("application/postscript"),
    EPUB("application/epub+zip"),
    ERF("image/x-epson-erf"),
    ES3("application/vnd.eszigno3+xml"),
    ESF("application/vnd.epson.esf"),
    ET3("application/vnd.eszigno3+xml"),
    ETX("text/x-setext"),
    EXE("application/x-msdownload"),
    EXT("application/vnd.novadigm.ext"),
    EZ("application/andrew-inset"),
    EZ2("application/vnd.ezpix-album"),
    EZ3("application/vnd.ezpix-package"),
    F("text/x-fortran"),
    F4V("video/x-f4v"),
    F77("text/x-fortran"),
    F90("text/x-fortran"),
    FBS("image/vnd.fastbidsheet"),
    FDF("application/vnd.fdf"),
    FE_LAUNCH("application/vnd.denovo.fcselayout-link"),
    FG5("application/vnd.fujitsu.oasysgp"),
    FGD("application/x-director"),
    FH("image/x-freehand"),
    FH4("image/x-freehand"),
    FH5("image/x-freehand"),
    FH7("image/x-freehand"),
    FHC("image/x-freehand"),
    FIG("application/x-xfig"),
    FLAC("audio/flac"),
    FLI("video/x-fli"),
    FLO("application/vnd.micrografx.flo"),
    FLV("video/x-flv"),
    FLW("application/vnd.kde.kivio"),
    FLX("text/vnd.fmi.flexstor"),
    FLY("text/vnd.fly"),
    FM("application/vnd.framemaker"),
    FNC("application/vnd.frogans.fnc"),
    FOR("text/x-fortran"),
    FPX("image/vnd.fpx"),
    FRAME("application/vnd.framemaker"),
    FSC("application/vnd.fsc.weblaunch"),
    FST("image/vnd.fst"),
    FTC("application/vnd.fluxtime.clip"),
    FTI("application/vnd.anser-web-funds-transfer-initiation"),
    FVT("video/vnd.fvt"),
    FZS("application/vnd.fuzzysheet"),
    G3("image/g3fax"),
    GAC("application/vnd.groove-account"),
    GBR("application/vnd.gerber"),
    GDL("model/vnd.gdl"),
    GEO("application/vnd.dynageo"),
    GEX("application/vnd.geometry-explorer"),
    GGB("application/vnd.geogebra.file"),
    GGT("application/vnd.geogebra.tool"),
    GHF("application/vnd.groove-help"),
    GIF("image/gif"),
    GIM("application/vnd.groove-identity-message"),
    GMX("application/vnd.gmx"),
    GNUMERIC("application/x-gnumeric"),
    GPH("application/vnd.flographit"),
    GQF("application/vnd.grafeq"),
    GQS("application/vnd.grafeq"),
    GRAM("application/srgs"),
    GRE("application/vnd.geometry-explorer"),
    GRV("application/vnd.groove-injector"),
    GRXML("application/srgs+xml"),
    GSF("application/x-font-ghostscript"),
    GTAR("application/x-gtar"),
    GTM("application/vnd.groove-tool-message"),
    GTW("model/vnd.gtw"),
    GV("text/vnd.graphviz"),
    GZ("application/gzip"),
    H("text/x-c"),
    H261("video/h261"),
    H263("video/h263"),
    H264("video/h264"),
    HBCI("application/vnd.hbci"),
    HDF("application/x-hdf"),
    HEIC("image/heic"),
    HEIF("image/heic"),
    HH("text/x-c"),
    HLP("application/winhlp"),
    HPGL("application/vnd.hp-hpgl"),
    HPID("application/vnd.hp-hpid"),
    HPS("application/vnd.hp-hps"),
    HQX("application/mac-binhex40"),
    HTKE("application/vnd.kenameaapp"),
    HTM("text/html"),
    HTML("text/html"),
    HVD("application/vnd.yamaha.hv-dic"),
    HVP("application/vnd.yamaha.hv-voice"),
    HVS("application/vnd.yamaha.hv-script"),
    ICC("application/vnd.iccprofile"),
    ICE("x-conference/x-cooltalk"),
    ICM("application/vnd.iccprofile"),
    ICNS("image/x-icns"),
    ICO("image/x-icon"),
    ICS("text/calendar"),
    IEF("image/ief"),
    IFB("text/calendar"),
    IFM("application/vnd.shana.informed.formdata"),
    IGES("model/iges"),
    IGL("application/vnd.igloader"),
    IGS("model/iges"),
    IGX("application/vnd.micrografx.igx"),
    IIF("application/vnd.shana.informed.interchange"),
    IMP("application/vnd.accpac.simply.imp"),
    IMS("application/vnd.ms-ims"),
    IN("text/plain"),
    INC("text/x-pascal"),
    IPK("application/vnd.shana.informed.package"),
    IRM("application/vnd.ibm.rights-management"),
    IRP("application/vnd.irepository.package+xml"),
    ISO("application/x-iso9660-image"),
    ISOIMG("application/x-iso9660-image"),
    ITP("application/vnd.shana.informed.formtemplate"),
    IVP("application/vnd.immervision-ivp"),
    IVU("application/vnd.immervision-ivu"),
    JAD("text/vnd.sun.j2me.app-descriptor"),
    JAM("application/vnd.jam"),
    JAR("application/java-archive"),
    JAVA("text/x-java-source"),
    JFI("image/pjpeg"),
    JFIF("image/pjpeg"),
    JFIF_TBNL("image/pjpeg"),
    JIF("image/pjpeg"),
    JISP("application/vnd.jisp"),
    JLT("application/vnd.hp-jlyt"),
    JNLP("application/x-java-jnlp-file"),
    JODA("application/vnd.joost.joda-archive"),
    JPE("image/jpeg"),
    JPEG("image/pjpeg"),
    JPG("image/pjpeg"),
    JPGM("video/jpm"),
    JPGV("video/jpeg"),
    JPM("video/jpm"),
    JS("text/javascript"),
    JSON("application/json"),
    K25("image/x-kodak-k25"),
    KAR("audio/midi"),
    KARBON("application/vnd.kde.karbon"),
    KDC("image/x-kodak-kdc"),
    KFO("application/vnd.kde.kformula"),
    KIA("application/vnd.kidspiration"),
    KIL("application/x-killustrator"),
    KML("application/vnd.google-earth.kml+xml"),
    KMZ("application/vnd.google-earth.kmz"),
    KNE("application/vnd.kinar"),
    KNP("application/vnd.kinar"),
    KON("application/vnd.kde.kontour"),
    KPR("application/vnd.kde.kpresenter"),
    KPT("application/vnd.kde.kpresenter"),
    KRA("application/x-krita"),
    KRZ("application/x-krita"),
    KSH("text/plain"),
    KSP("application/vnd.kde.kspread"),
    KTR("application/vnd.kahootz"),
    KTZ("application/vnd.kahootz"),
    KWD("application/vnd.kde.kword"),
    KWT("application/vnd.kde.kword"),
    LATEX("application/x-latex"),
    LBD("application/vnd.llamagraphics.life-balance.desktop"),
    LBE("application/vnd.llamagraphics.life-balance.exchange+xml"),
    LES("application/vnd.hhe.lesson-player"),
    LHA("application/octet-stream"),
    LINK66("application/vnd.route66.link66+xml"),
    LIST("text/plain"),
    LIST3820("application/vnd.ibm.modcap"),
    LISTAFP("application/vnd.ibm.modcap"),
    LOG("text/plain"),
    LOSTXML("application/lost+xml"),
    LRF("application/octet-stream"),
    LRM("application/vnd.ms-lrm"),
    LTF("application/vnd.frogans.ltf"),
    LVP("audio/vnd.lucent.voice"),
    LWP("application/vnd.lotus-wordpro"),
    LZH("application/octet-stream"),
    M13("application/x-msmediaview"),
    M14("application/x-msmediaview"),
    M1V("video/mpeg"),
    M2A("audio/mpeg"),
    M2V("video/mpeg"),
    M3A("audio/mpeg"),
    M3U("audio/x-mpegurl"),
    M4A("audio/mp4"),
    M4B("audio/mp4"),
    M4P("audio/mp4"),
    M4R("audio/mp4"),
    M4U("video/vnd.mpegurl"),
    M4V("audio/mp4"),
    MA("application/mathematica"),
    MAG("application/vnd.ecowin.chart"),
    MAKER("application/vnd.framemaker"),
    MAN("text/troff"),
    MARKDN("text/markdown"),
    MARKDOWN("text/markdown"),
    MATHML("application/mathml+xml"),
    MB("application/mathematica"),
    MBK("application/vnd.mobius.mbk"),
    MBOX("application/mbox"),
    MC1("application/vnd.medcalcdata"),
    MCD("application/vnd.mcd"),
    MCURL("text/vnd.curl.mcurl"),
    MD("text/markdown"),
    MDB("application/x-msaccess"),
    MDI("image/vnd.ms-modi"),
    MDOWN("text/markdown"),
    ME("text/troff"),
    MESH("model/mesh"),
    MFM("application/vnd.mfmp"),
    MGZ("application/vnd.proteus.magazine"),
    MHT("message/rfc822"),
    MHTML("message/rfc822"),
    MID("audio/midi"),
    MIDI("audio/midi"),
    MIF("application/vnd.mif"),
    MIME("message/rfc822"),
    MJ2("video/mj2"),
    MJP2("video/mj2"),
    MKA("audio/x-matroska"),
    MKV("video/x-matroska"),
    MLP("application/vnd.dolby.mlp"),
    MMD("application/vnd.chipnuts.karaoke-mmd"),
    MMF("application/vnd.smaf"),
    MML("text/mathml"),
    MMR("image/vnd.fujixerox.edmics-mmr"),
    MNY("application/x-msmoney"),
    MOBI("application/x-mobipocket-ebook"),
    MOV("video/quicktime"),
    MOVIE("video/x-sgi-movie"),
    MP2("audio/mpeg"),
    MP2A("audio/mpeg"),
    MP3("audio/mpeg"),
    MP4("audio/mp4"),
    MP4S("application/mp4"),
    MP4V("video/mp4"),
    MPA("video/mpeg"),
    MPC("application/vnd.mophun.certificate"),
    MPE("video/mpeg"),
    MPEG("video/mpeg"),
    MPG("video/mpeg"),
    MPG4("video/mp4"),
    MPGA("audio/mpeg"),
    MPKG("application/vnd.apple.installer+xml"),
    MPM("application/vnd.blueice.multipass"),
    MPN("application/vnd.mophun.application"),
    MPP("application/vnd.ms-project"),
    MPT("application/vnd.ms-project"),
    MPY("application/vnd.ibm.minipay"),
    MQY("application/vnd.mobius.mqy"),
    MRC("application/marc"),
    MRW("image/x-minolta-mrw"),
    MS("text/troff"),
    MSCML("application/mediaservercontrol+xml"),
    MSEED("application/vnd.fdsn.mseed"),
    MSEQ("application/vnd.mseq"),
    MSF("application/vnd.epson.msf"),
    MSH("model/mesh"),
    MSI("application/x-msdownload"),
    MSL("application/vnd.mobius.msl"),
    MSTY("application/vnd.muvee.style"),
    MTS("model/vnd.mts"),
    MUS("application/vnd.musician"),
    MUSICXML("application/vnd.recordare.musicxml+xml"),
    MVB("application/x-msmediaview"),
    MWF("application/vnd.mfer"),
    MXF("application/mxf"),
    MXL("application/vnd.recordare.musicxml"),
    MXML("application/xv+xml"),
    MXS("application/vnd.triscape.mxs"),
    MXU("video/vnd.mpegurl"),
    N_GAGE("application/vnd.nokia.n-gage.symbian.install"),
    NB("application/mathematica"),
    NC("application/x-netcdf"),
    NCX("application/x-dtbncx+xml"),
    NEF("image/x-nikon-nef"),
    NGDAT("application/vnd.nokia.n-gage.data"),
    NLU("application/vnd.neurolanguage.nlu"),
    NML("application/vnd.enliven"),
    NND("application/vnd.noblenet-directory"),
    NNS("application/vnd.noblenet-sealer"),
    NNW("application/vnd.noblenet-web"),
    NPX("image/vnd.net-fpx"),
    NSF("application/vnd.lotus-notes"),
    NWS("message/rfc822"),
    O("application/octet-stream"),
    OA2("application/vnd.fujitsu.oasys2"),
    OA3("application/vnd.fujitsu.oasys3"),
    OAS("application/vnd.fujitsu.oasys"),
    OBD("application/x-msbinder"),
    OBJ("application/octet-stream"),
    ODA("application/oda"),
    ODB("application/vnd.oasis.opendocument.database"),
    ODC("application/vnd.oasis.opendocument.chart"),
    ODF("application/vnd.oasis.opendocument.formula"),
    ODFT("application/vnd.oasis.opendocument.formula-template"),
    ODG("application/vnd.oasis.opendocument.graphics"),
    ODI("application/vnd.oasis.opendocument.image"),
    ODP("application/vnd.oasis.opendocument.presentation"),
    ODS("application/vnd.oasis.opendocument.spreadsheet"),
    ODT("application/vnd.oasis.opendocument.text"),
    OGA("audio/ogg"),
    OGG("audio/ogg"),
    OGV("video/ogg"),
    OGX("application/ogg"),
    ONEPKG("application/onenote"),
    ONETMP("application/onenote"),
    ONETOC("application/onenote"),
    ONETOC2("application/onenote"),
    OPF("application/oebps-package+xml"),
    OPRC("application/vnd.palm"),
    OPUS("audio/opus"),
    ORF("image/x-olympus-orf"),
    ORG("application/vnd.lotus-organizer"),
    OSF("application/vnd.yamaha.openscoreformat"),
    OSFPVG("application/vnd.yamaha.openscoreformat.osfpvg+xml"),
    OTC("application/vnd.oasis.opendocument.chart-template"),
    OTF("application/x-font-otf"),
    OTG("application/vnd.oasis.opendocument.graphics-template"),
    OTH("application/vnd.oasis.opendocument.text-web"),
    OTI("application/vnd.oasis.opendocument.image-template"),
    OTM("application/vnd.oasis.opendocument.text-master"),
    OTP("application/vnd.oasis.opendocument.presentation-template"),
    OTS("application/vnd.oasis.opendocument.spreadsheet-template"),
    OTT("application/vnd.oasis.opendocument.text-template"),
    OXT("application/vnd.openofficeorg.extension"),
    P("text/x-pascal"),
    P10("application/pkcs10"),
    P12("application/x-pkcs12"),
    P7B("application/x-pkcs7-certificates"),
    P7C("application/pkcs7-mime"),
    P7M("application/pkcs7-mime"),
    P7R("application/x-pkcs7-certreqresp"),
    P7S("application/pkcs7-signature"),
    PAS("text/x-pascal"),
    PBD("application/vnd.powerbuilder6"),
    PBM("image/x-portable-bitmap"),
    PCF("application/x-font-pcf"),
    PCL("application/vnd.hp-pcl"),
    PCLXL("application/vnd.hp-pclxl"),
    PCT("image/x-pict"),
    PCURL("application/vnd.curl.pcurl"),
    PCX("image/x-pcx"),
    PDB("application/vnd.palm"),
    PDF("application/pdf"),
    PEF("image/x-pentax-pef"),
    PFA("application/x-font-type1"),
    PFB("application/x-font-type1"),
    PFM("application/x-font-type1"),
    PFR("application/font-tdpfr"),
    PFX("application/x-pkcs12"),
    PGM("image/x-portable-graymap"),
    PGN("application/x-chess-pgn"),
    PGP("application/pgp-encrypted"),
    PIC("image/x-pict"),
    PJPG("image/pjpeg"),
    PKG("application/octet-stream"),
    PKI("application/pkixcmp"),
    PKIPATH("application/pkix-pkipath"),
    PL("text/plain"),
    PLB("application/vnd.3gpp.pic-bw-large"),
    PLC("application/vnd.mobius.plc"),
    PLF("application/vnd.pocketlearn"),
    PLS("application/pls+xml"),
    PM("application/x-perl"),
    PML("application/vnd.ctc-posml"),
    PNG("image/png"),
    PNM("image/x-portable-anymap"),
    PORTPKG("application/vnd.macports.portpkg"),
    POT("application/vnd.ms-powerpoint"),
    POTM("application/vnd.ms-powerpoint.template.macroenabled.12"),
    POTX("application/vnd.openxmlformats-officedocument.presentationml.template"),
    PP("text/x-pascal"),
    PPA("application/vnd.ms-powerpoint"),
    PPAM("application/vnd.ms-powerpoint.addin.macroenabled.12"),
    PPD("application/vnd.cups-ppd"),
    PPM("image/x-portable-pixmap"),
    PPS("application/vnd.ms-powerpoint"),
    PPSM("application/vnd.ms-powerpoint.slideshow.macroenabled.12"),
    PPSX("application/vnd.openxmlformats-officedocument.presentationml.slideshow"),
    PPT("application/vnd.ms-powerpoint"),
    PPTM("application/vnd.ms-powerpoint.presentation.macroenabled.12"),
    PPTX("application/vnd.openxmlformats-officedocument.presentationml.presentation"),
    PQA("application/vnd.palm"),
    PRC("application/x-mobipocket-ebook"),
    PRE("application/vnd.lotus-freelance"),
    PRF("application/pics-rules"),
    PRQL("application/prql"),
    PS("application/postscript"),
    PSB("application/vnd.3gpp.pic-bw-small"),
    PSD("image/vnd.adobe.photoshop"),
    PSF("application/x-font-linux-psf"),
    PTID("application/vnd.pvi.ptid1"),
    PTX("image/x-pentax-pef"),
    PUB("application/x-mspublisher"),
    PVB("application/vnd.3gpp.pic-bw-var"),
    PWN("application/vnd.3m.post-it-notes"),
    PWZ("application/vnd.ms-powerpoint"),
    PY("text/x-python"),
    PYA("audio/vnd.ms-playready.media.pya"),
    PYC("text/x-python"),
    PYD("text/x-python"),
    PYO("text/x-python"),
    PYV("video/vnd.ms-playready.media.pyv"),
    QAM("application/vnd.epson.quickanime"),
    QBO("application/vnd.intu.qbo"),
    QFX("application/vnd.intu.qfx"),
    QPS("application/vnd.publishare-delta-tree"),
    QT("video/quicktime"),
    QWD("application/vnd.quark.quarkxpress"),
    QWT("application/vnd.quark.quarkxpress"),
    QXB("application/vnd.quark.quarkxpress"),
    QXD("application/vnd.quark.quarkxpress"),
    QXL("application/vnd.quark.quarkxpress"),
    QXT("application/vnd.quark.quarkxpress"),
    RA("audio/x-pn-realaudio"),
    RAF("image/x-fuji-raf"),
    RAM("audio/x-pn-realaudio"),
    RAR("application/vnd.rar"),
    RAS("image/x-cmu-raster"),
    RAW("image/x-panasonic-raw"),
    RCPROFILE("application/vnd.ipunplugged.rcprofile"),
    RDF("application/rdf+xml"),
    RDZ("application/vnd.data-vision.rdz"),
    REP("application/vnd.businessobjects"),
    RES("application/x-dtbresource+xml"),
    RGB("image/x-rgb"),
    RIF("application/reginfo+xml"),
    RL("application/resource-lists+xml"),
    RLC("image/vnd.fujixerox.edmics-rlc"),
    RLD("application/resource-lists-diff+xml"),
    RM("application/vnd.rn-realmedia"),
    RMI("audio/midi"),
    RMP("audio/x-pn-realaudio-plugin"),
    RMS("application/vnd.jcp.javame.midlet-rms"),
    RNC("application/relax-ng-compact-syntax"),
    ROFF("text/troff"),
    RPA("application/x-redhat-package-manager"),
    RPM("application/x-rpm"),
    RPSS("application/vnd.nokia.radio-presets"),
    RPST("application/vnd.nokia.radio-preset"),
    RQ("application/sparql-query"),
    RS("application/rls-services+xml"),
    RSD("application/rsd+xml"),
    RSS("application/rss+xml"),
    RTF("application/rtf"),
    RTX("text/richtext"),
    RW2("image/x-panasonic-raw"),
    RWL("image/x-panasonic-raw"),
    S("text/x-asm"),
    SAF("application/vnd.yamaha.smaf-audio"),
    SBML("application/sbml+xml"),
    SC("application/vnd.ibm.secure-container"),
    SCD("application/x-msschedule"),
    SCM("application/vnd.lotus-screencam"),
    SCQ("application/scvp-cv-request"),
    SCS("application/scvp-cv-response"),
    SCURL("text/vnd.curl.scurl"),
    SDA("application/vnd.stardivision.draw"),
    SDC("application/vnd.stardivision.calc"),
    SDD("application/vnd.stardivision.impress"),
    SDKD("application/vnd.solent.sdkm+xml"),
    SDKM("application/vnd.solent.sdkm+xml"),
    SDP("application/sdp"),
    SDW("application/vnd.stardivision.writer"),
    SEE("application/vnd.seemail"),
    SEED("application/vnd.fdsn.seed"),
    SEMA("application/vnd.sema"),
    SEMD("application/vnd.semd"),
    SEMF("application/vnd.semf"),
    SER("application/java-serialized-object"),
    SETPAY("application/set-payment-initiation"),
    SETREG("application/set-registration-initiation"),
    SFD_HDSTX("application/vnd.hydrostatix.sof-data"),
    SFS("application/vnd.spotfire.sfs"),
    SGL("application/vnd.stardivision.writer-global"),
    SGM("text/sgml"),
    SGML("text/sgml"),
    SH("application/x-sh"),
    SHAR("application/x-shar"),
    SHF("application/shf+xml"),
    SI("text/vnd.wap.si"),
    SIC("application/vnd.wap.sic"),
    SIG("application/pgp-signature"),
    SILO("model/mesh"),
    SIS("application/vnd.symbian.install"),
    SISX("application/vnd.symbian.install"),
    SIT("application/x-stuffit"),
    SITX("application/x-stuffitx"),
    SKD("application/vnd.koan"),
    SKM("application/vnd.koan"),
    SKP("application/vnd.koan"),
    SKT("application/vnd.koan"),
    SL("text/vnd.wap.sl"),
    SLC("application/vnd.wap.slc"),
    SLDM("application/vnd.ms-powerpoint.slide.macroenabled.12"),
    SLDX("application/vnd.openxmlformats-officedocument.presentationml.slide"),
    SLT("application/vnd.epson.salt"),
    SMF("application/vnd.stardivision.math"),
    SMI("application/smil+xml"),
    SMIL("application/smil+xml"),
    SND("audio/basic"),
    SNF("application/x-font-snf"),
    SO("application/octet-stream"),
    SPC("application/x-pkcs7-certificates"),
    SPF("application/vnd.yamaha.smaf-phrase"),
    SPL("application/x-futuresplash"),
    SPOT("text/vnd.in3d.spot"),
    SPP("application/scvp-vp-response"),
    SPQ("application/scvp-vp-request"),
    SPX("audio/ogg"),
    SQLITE("application/vnd.sqlite3"),
    SQLITE_SHM("application/vnd.sqlite3"),
    SQLITE_WAL("application/vnd.sqlite3"),
    SQLITE3("application/vnd.sqlite3"),
    SR2("image/x-sony-sr2"),
    SRC("application/x-wais-source"),
    SRF("image/x-sony-srf"),
    SRX("application/sparql-results+xml"),
    SSE("application/vnd.kodak-descriptor"),
    SSF("application/vnd.epson.ssf"),
    SSML("application/ssml+xml"),
    STC("application/vnd.sun.xml.calc.template"),
    STD("application/vnd.sun.xml.draw.template"),
    STF("application/vnd.wt.stf"),
    STI("application/vnd.sun.xml.impress.template"),
    STK("application/hyperstudio"),
    STL("application/vnd.ms-pki.stl"),
    STR("application/vnd.pg.format"),
    STW("application/vnd.sun.xml.writer.template"),
    SUS("application/vnd.sus-calendar"),
    SUSP("application/vnd.sus-calendar"),
    SV4CPIO("application/x-sv4cpio"),
    SV4CRC("application/x-sv4crc"),
    SVD("application/vnd.svd"),
    SVG("image/svg+xml"),
    SVGZ("image/svg+xml"),
    SWA("application/x-director"),
    SWF("application/x-shockwave-flash"),
    SWI("application/vnd.arastra.swi"),
    SXC("application/vnd.sun.xml.calc"),
    SXD("application/vnd.sun.xml.draw"),
    SXG("application/vnd.sun.xml.writer.global"),
    SXI("application/vnd.sun.xml.impress"),
    SXM("application/vnd.sun.xml.math"),
    SXW("application/vnd.sun.xml.writer"),
    T("text/troff"),
    TAO("application/vnd.tao.intent-module-archive"),
    TAR("application/x-tar"),
    TCAP("application/vnd.3gpp2.tcap"),
    TCL("application/x-tcl"),
    TEACHER("application/vnd.smart.teacher"),
    TEST("test/mimetype"),
    TEX("application/x-tex"),
    TEXI("application/x-texinfo"),
    TEXINFO("application/x-texinfo"),
    TEXT("text/plain"),
    TFM("application/x-tex-tfm"),
    TGZ("application/x-gzip"),
    TIF("image/tiff"),
    TIFF("image/tiff"),
    TMO("application/vnd.tmobile-livetv"),
    TORRENT("application/x-bittorrent"),
    TPL("application/vnd.groove-tool-template"),
    TPT("application/vnd.trid.tpt"),
    TR("text/troff"),
    TRA("application/vnd.trueapp"),
    TRM("application/x-msterminal"),
    TS("video/mp2t"),
    TSV("text/tab-separated-values"),
    TTC("application/x-font-ttf"),
    TTF("application/x-font-ttf"),
    TWD("application/vnd.simtech-mindmapper"),
    TWDS("application/vnd.simtech-mindmapper"),
    TXD("application/vnd.genomatix.tuxedo"),
    TXF("application/vnd.mobius.txf"),
    TXT("text/plain"),
    U32("application/x-authorware-bin"),
    UDEB("application/x-debian-package"),
    UFD("application/vnd.ufdl"),
    UFDL("application/vnd.ufdl"),
    UMJ("application/vnd.umajin"),
    UNITYWEB("application/vnd.unity"),
    UOML("application/vnd.uoml+xml"),
    URI("text/uri-list"),
    URIS("text/uri-list"),
    URLS("text/uri-list"),
    USTAR("application/x-ustar"),
    UTZ("application/vnd.uiq.theme"),
    UU("text/x-uuencode"),
    VCD("application/x-cdlink"),
    VCF("text/x-vcard"),
    VCG("application/vnd.groove-vcard"),
    VCS("text/x-vcalendar"),
    VCX("application/vnd.vcx"),
    VIS("application/vnd.visionary"),
    VIV("video/vnd.vivo"),
    VOR("application/vnd.stardivision.writer"),
    VOX("application/x-authorware-bin"),
    VRML("model/vrml"),
    VSD("application/vnd.visio"),
    VSDX("application/vnd.visio"),
    VSF("application/vnd.vsf"),
    VSS("application/vnd.visio"),
    VSSM("application/vnd.visio"),
    VSSX("application/vnd.visio"),
    VST("application/vnd.visio"),
    VSTM("application/vnd.visio"),
    VSTX("application/vnd.visio"),
    VSW("application/vnd.visio"),
    VTU("model/vnd.vtu"),
    VXML("application/voicexml+xml"),
    W3D("application/x-director"),
    WAD("application/x-doom"),
    WASM("application/wasm"),
    WAV("audio/vnd.wav"),
    WAX("audio/x-ms-wax"),
    WBMP("image/vnd.wap.wbmp"),
    WBS("application/vnd.criticaltools.wbs+xml"),
    WBXML("application/vnd.wap.wbxml"),
    WCM("application/vnd.ms-works"),
    WDB("application/vnd.ms-works"),
    WEBA("audio/webm"),
    WEBM("video/webm"),
    WEBP("image/webp"),
    WHL("text/x-python"),
    WIZ("application/msword"),
    WKS("application/vnd.ms-works"),
    WM("video/x-ms-wm"),
    WMA("audio/x-ms-wma"),
    WMD("application/x-ms-wmd"),
    WMF("application/x-msmetafile"),
    WML("text/vnd.wap.wml"),
    WMLC("application/vnd.wap.wmlc"),
    WMLS("text/vnd.wap.wmlscript"),
    WMLSC("application/vnd.wap.wmlscriptc"),
    WMV("video/x-ms-wmv"),
    WMX("video/x-ms-wmx"),
    WMZ("application/x-ms-wmz"),
    WOFF("font/woff"),
    WOFF2("font/woff2"),
    WPD("application/vnd.wordperfect"),
    WPL("application/vnd.ms-wpl"),
    WPS("application/vnd.ms-works"),
    WQD("application/vnd.wqd"),
    WRI("application/x-mswrite"),
    WRL("model/vrml"),
    WSDL("application/wsdl+xml"),
    WSPOLICY("application/wspolicy+xml"),
    WTB("application/vnd.webturbo"),
    WVX("video/x-ms-wvx"),
    X32("application/x-authorware-bin"),
    X3D("application/vnd.hzn-3d-crossword"),
    X3F("image/x-sigma-x3f"),
    XAP("application/x-silverlight-app"),
    XAR("application/vnd.xara"),
    XBAP("application/x-ms-xbap"),
    XBD("application/vnd.fujixerox.docuworks.binder"),
    XBM("image/x-xbitmap"),
    XDM("application/vnd.syncml.dm+xml"),
    XDP("application/vnd.adobe.xdp+xml"),
    XDW("application/vnd.fujixerox.docuworks"),
    XENC("application/xenc+xml"),
    XER("application/patch-ops-error+xml"),
    XFDF("application/vnd.adobe.xfdf"),
    XFDL("application/vnd.xfdl"),
    XHT("application/xhtml+xml"),
    XHTML("application/xhtml+xml"),
    XHVML("application/xv+xml"),
    XIF("image/vnd.xiff"),
    XLA("application/vnd.ms-excel"),
    XLAM("application/vnd.ms-excel.addin.macroenabled.12"),
    XLB("application/vnd.ms-excel"),
    XLC("application/vnd.ms-excel"),
    XLM("application/vnd.ms-excel"),
    XLS("application/vnd.ms-excel"),
    XLSB("application/vnd.ms-excel.sheet.binary.macroenabled.12"),
    XLSM("application/vnd.ms-excel.sheet.macroenabled.12"),
    XLSX("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),
    XLT("application/vnd.ms-excel"),
    XLTM("application/vnd.ms-excel.template.macroenabled.12"),
    XLTX("application/vnd.openxmlformats-officedocument.spreadsheetml.template"),
    XLW("application/vnd.ms-excel"),
    XML("application/rss+xml"),
    XO("application/vnd.olpc-sugar"),
    XOP("application/xop+xml"),
    XPDL("application/xml"),
    XPI("application/x-xpinstall"),
    XPM("image/x-xpixmap"),
    XPR("application/vnd.is-xpr"),
    XPS("application/vnd.ms-xpsdocument"),
    XPW("application/vnd.intercon.formnet"),
    XPX("application/vnd.intercon.formnet"),
    XSL("application/xml"),
    XSLT("application/xslt+xml"),
    XSM("application/vnd.syncml+xml"),
    XSPF("application/xspf+xml"),
    XUL("application/vnd.mozilla.xul+xml"),
    XVM("application/xv+xml"),
    XVML("application/xv+xml"),
    XWD("image/x-xwindowdump"),
    XYZ("chemical/x-xyz"),
    YAML("application/yaml"),
    YML("application/yaml"),
    ZABW("application/x-abiword"),
    ZAZ("application/vnd.zzazz.deck+xml"),
    ZIP("application/x-zip-compressed"),
    ZIR("application/vnd.zul"),
    ZIRZ("application/vnd.zul"),
    ZMM("application/vnd.handheld-entertainment+xml");


    private static final String CSV_MIMETYPES_CSV = "csv/mimetypes.csv";
    private static final String FAILED_TO_LOAD_CSV = "Failed to load csv/mimetypes.csv from the libdmotservices JAR.";
    private final String mimeType;

    MimeType(String mimeType) {
        this.mimeType = mimeType;
    }

    public String getMimeType() {
        return mimeType;

    }

    public static MimeType fromString(String type) {
        if (null == type)
            return null;
        final String trimmed = type.trim();
        for (MimeType mimeType : MimeType.values()) {
            if (mimeType.getMimeType().equalsIgnoreCase(trimmed)) {
                return mimeType;
            }
        }
        return null;
    }

    public static MimeType fromPartialString(String partialType) {
        if (null == partialType || partialType.isBlank())
            return null;
        final String trimmed = partialType.trim();
        final String mimeTypeString = extensionAsMimeTypeString(trimmed);
        for (MimeType mimeType : MimeType.values()) {
            if (mimeType.getMimeType().contains(trimmed))
                return mimeType;
            if (null != mimeTypeString && mimeType.getMimeType().contains(mimeTypeString.toLowerCase()))
                return mimeType;
        }
        return null;
    }

    public static String extensionAsMimeTypeString(String extension) {
        if (null == extension || extension.isBlank())
            return null;
        try {
            final String mimeTypes = FileUtils.loadResourceAsString(MimeType.class, CSV_MIMETYPES_CSV);
            if (!extension.startsWith(".")) {
                extension = "." + extension;
            }
            final String regex = "^(.*)" + Pattern.quote(extension.toLowerCase());
            final Pattern pattern = Pattern.compile(regex, Pattern.MULTILINE);
            final Matcher matcher = pattern.matcher(mimeTypes);
            if (matcher.find()) {
                // For example, a search for "jpg" will return: "image/jpeg;.jpe, .jpeg,". We discard what we don't need.
                final String termsBeforeExt = matcher.group(1).trim();
                return termsBeforeExt.split(";")[0].trim();
            }
        } catch (IOException e) {
            throw new IllegalStateException(FAILED_TO_LOAD_CSV);
        }
        return null;
    }

    /*
     * Dots are preserved in the extensions. Example:
     * .jpg => "image/jpeg"
     */
    public static Map<String, String> fileExtensionMimeTypeStringMap() {

        final Map<String, String> mapExtMime = new ConcurrentHashMap<>();
        final String mimeTypes;
        try {
            mimeTypes = FileUtils.loadResourceAsString(MimeType.class, CSV_MIMETYPES_CSV);
        } catch (IOException e) {
            throw new IllegalStateException(FAILED_TO_LOAD_CSV);
        }
        for (String line : mimeTypes.split("\\R")) {
            final String[] parts = line.split(";");
            if (parts.length < 2 || null == parts[0] || null == parts[1] || !parts[0].contains("/"))
                continue;
            final String mimeTypeString = parts[0].trim();
            final String extensionCSV = parts[1].trim();
            final String[] extensions = extensionCSV.split(",");
            for (String extension : extensions) {
                if (!mapExtMime.containsKey(extension))
                    // some extensions are assigned to different mime types!
                    mapExtMime.put(
                            extension.replaceAll("\\s", ""),
                            mimeTypeString.replaceAll("\\s", ""));
            }
        }
        return mapExtMime;
    }

    @Override
    public String toString() {
        return mimeType;
    }
}
